<!DOCTYPE html>
<html lang="{{ lang or 'en' }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üî¨ {{ t('quantum_attack_simulator') or 'Quantum Attack Simulator - Allianza Blockchain' }}</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
            color: #fff;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
            background: linear-gradient(135deg, #8b5cf6, #06b6d4, #10b981);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .subtitle {
            text-align: center;
            margin-bottom: 40px;
            font-size: 1.2em;
            opacity: 0.9;
            color: #94a3b8;
        }
        
        /* Processo Visual Passo a Passo */
        .process-container {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(148, 163, 184, 0.1);
            display: none;
        }
        
        .process-container.active {
            display: block;
        }
        
        .process-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .process-header h2 {
            font-size: 1.8em;
            margin-bottom: 10px;
        }
        
        .process-steps {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .step-item {
            background: rgba(15, 23, 42, 0.6);
            border-radius: 10px;
            padding: 20px;
            border-left: 4px solid #475569;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .step-item.active {
            border-left-color: #8b5cf6;
            background: rgba(139, 92, 246, 0.1);
            animation: pulse-border 2s ease infinite;
        }
        
        .step-item.completed {
            border-left-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
        }
        
        .step-item.pending {
            opacity: 0.5;
        }
        
        @keyframes pulse-border {
            0%, 100% { border-left-width: 4px; }
            50% { border-left-width: 6px; }
        }
        
        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #475569;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
            flex-shrink: 0;
        }
        
        .step-item.active .step-number {
            background: #8b5cf6;
            animation: spin 1s linear infinite;
        }
        
        .step-item.completed .step-number {
            background: #10b981;
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .step-content {
            flex: 1;
        }
        
        .step-title {
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .step-description {
            font-size: 0.9em;
            color: #94a3b8;
        }
        
        .step-status {
            font-size: 1.5em;
            margin-left: auto;
        }
        
        /* Anima√ß√£o Visual do Ataque */
        .attack-animation-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 40px 0;
        }
        
        .animation-panel {
            background: rgba(30, 41, 59, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            padding: 25px;
            border: 3px solid;
            min-height: 550px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }
        
        .animation-panel.traditional {
            border-color: #ef4444;
        }
        
        .animation-panel.protected {
            border-color: #10b981;
        }
        
        .animation-title {
            text-align: center;
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 20px;
        }
        
        .animation-title.traditional {
            color: #ef4444;
        }
        
        .animation-title.protected {
            color: #10b981;
        }
        
        /* Wallet Animation */
        .wallet-container {
            position: relative;
            width: 100%;
            height: 450px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            gap: 25px;
            padding: 20px;
        }
        
        .wallet-icon {
            font-size: 70px;
            transition: all 0.5s ease;
            margin-top: 20px;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));
        }
        
        .lock-container {
            position: relative;
            width: 120px;
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 10px 0;
        }
        
        .lock-icon {
            font-size: 70px;
            transition: all 0.5s ease;
            position: absolute;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));
        }
        
        .lock-icon.broken {
            transform: rotate(45deg) scale(0.7);
            opacity: 0.4;
            color: #ef4444;
            animation: break-lock 0.8s ease;
        }
        
        .lock-icon.secure {
            color: #10b981;
            animation: pulse-glow 2s ease infinite;
        }
        
        @keyframes break-lock {
            0% {
                transform: rotate(0deg) scale(1);
                filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));
            }
            50% {
                transform: rotate(90deg) scale(1.2);
                filter: drop-shadow(0 0 20px rgba(239, 68, 68, 0.8));
            }
            100% {
                transform: rotate(45deg) scale(0.7);
                filter: drop-shadow(0 0 10px rgba(239, 68, 68, 0.5));
            }
        }
        
        @keyframes pulse-glow {
            0%, 100% { 
                filter: drop-shadow(0 0 15px rgba(16, 185, 129, 0.6));
                transform: scale(1);
            }
            50% { 
                filter: drop-shadow(0 0 25px rgba(16, 185, 129, 1));
                transform: scale(1.05);
            }
        }
        
        .key-icon {
            font-size: 60px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            opacity: 0;
            transition: all 0.5s ease;
            z-index: 10;
        }
        
        .key-icon.visible {
            opacity: 1;
            animation: float-up 1.5s ease forwards;
        }
        
        @keyframes float-up {
            0% {
                transform: translate(-50%, -50%) scale(0.3) rotate(-20deg);
                opacity: 0;
            }
            50% {
                transform: translate(-50%, -150%) scale(1) rotate(10deg);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -200%) scale(1.1) rotate(0deg);
                opacity: 0.8;
            }
        }
        
        .qubits-container {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
            overflow: hidden;
        }
        
        .qubit {
            position: absolute;
            width: 24px;
            height: 24px;
            background: radial-gradient(circle, #8b5cf6 0%, #4c1d95 50%, #1e1b4b 100%);
            border-radius: 50%;
            opacity: 0;
            box-shadow: 0 0 10px rgba(139, 92, 246, 0.8), 0 0 20px rgba(139, 92, 246, 0.4);
            animation: qubit-attack 2.5s ease forwards;
        }
        
        @keyframes qubit-attack {
            0% {
                opacity: 0;
                transform: translate(0, 0) scale(0);
            }
            20% {
                opacity: 1;
                transform: translate(calc(var(--target-x) * 0.3), calc(var(--target-y) * 0.3)) scale(0.8);
            }
            50% {
                opacity: 1;
                transform: translate(var(--target-x), var(--target-y)) scale(1.2);
            }
            80% {
                opacity: 0.8;
                transform: translate(var(--target-x), var(--target-y)) scale(1);
            }
            100% {
                opacity: 0;
                transform: translate(var(--target-x), var(--target-y)) scale(0);
            }
        }
        
        .funds-display {
            font-size: 2.2em;
            font-weight: bold;
            transition: all 0.5s ease;
            margin-top: 20px;
            padding: 15px 25px;
            background: rgba(15, 23, 42, 0.6);
            border-radius: 10px;
            border: 2px solid rgba(148, 163, 184, 0.2);
            min-width: 180px;
            text-align: center;
        }
        
        .funds-display.stolen {
            color: #ef4444;
            border-color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
            animation: shake 0.6s ease;
        }
        
        .funds-display.protected {
            color: #10b981;
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0) rotate(0deg); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-8px) rotate(-2deg); }
            20%, 40%, 60%, 80% { transform: translateX(8px) rotate(2deg); }
        }
        
        /* Protection Layers */
        .layers-container {
            display: flex;
            flex-direction: column;
            gap: 18px;
            width: 100%;
            margin-top: 30px;
            padding: 0 10px;
        }
        
        .protection-layer {
            background: rgba(15, 23, 42, 0.7);
            border-radius: 12px;
            padding: 22px;
            border: 3px solid;
            position: relative;
            transition: all 0.6s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        .protection-layer.layer1 {
            border-color: #ef4444;
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(15, 23, 42, 0.7));
        }
        
        .protection-layer.layer2 {
            border-color: #f59e0b;
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(15, 23, 42, 0.7));
        }
        
        .protection-layer.layer3 {
            border-color: #10b981;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(15, 23, 42, 0.7));
        }
        
        .protection-layer.attacked {
            border-color: #ef4444;
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.3), rgba(239, 68, 68, 0.1));
            animation: layer-break 0.8s ease;
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.4);
        }
        
        .protection-layer.resisted {
            border-color: #10b981;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.3), rgba(16, 185, 129, 0.1));
            animation: layer-resist 0.8s ease;
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.4);
        }
        
        @keyframes layer-break {
            0% { 
                transform: scale(1) rotate(0deg);
                border-color: #ef4444;
            }
            30% { 
                transform: scale(0.92) rotate(-2deg);
                border-color: #dc2626;
            }
            60% { 
                transform: scale(0.95) rotate(2deg);
                border-color: #ef4444;
            }
            100% { 
                transform: scale(1) rotate(0deg);
                border-color: #ef4444;
            }
        }
        
        @keyframes layer-resist {
            0%, 100% { 
                transform: scale(1);
            }
            25% { 
                transform: scale(1.03);
                box-shadow: 0 0 25px rgba(16, 185, 129, 0.6);
            }
            50% { 
                transform: scale(1.05);
                box-shadow: 0 0 30px rgba(16, 185, 129, 0.8);
            }
            75% { 
                transform: scale(1.03);
                box-shadow: 0 0 25px rgba(16, 185, 129, 0.6);
            }
        }
        
        .layer-name {
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 1.05em;
        }
        
        .layer-status {
            font-size: 0.95em;
            color: #cbd5e1;
            line-height: 1.4;
        }
        
        .attack-indicator {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 2em;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
        }
        
        /* Tabela Simplificada */
        .comparison-table {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            border: 1px solid rgba(148, 163, 184, 0.1);
        }
        
        .comparison-table h2 {
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid rgba(148, 163, 184, 0.1);
        }
        
        th {
            background: rgba(15, 23, 42, 0.6);
            font-weight: 600;
            color: #cbd5e1;
        }
        
        tr:hover {
            background: rgba(139, 92, 246, 0.1);
        }
        
        .status-icon {
            font-size: 1.5em;
            text-align: center;
        }
        
        /* Bot√µes */
        .btn {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
            margin: 5px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 92, 246, 0.4);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            font-size: 1.3em;
            padding: 20px 40px;
        }
        
        .btn-proof {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            font-size: 1.2em;
            padding: 18px 35px;
            margin-top: 20px;
            width: 100%;
            max-width: 500px;
        }
        
        .btn-container {
            text-align: center;
            margin: 30px 0;
        }
        
        /* Resultados */
        #results {
            display: none;
        }
        
        #results.active {
            display: block;
        }
        
        .conclusion {
            text-align: center;
            font-size: 1.3em;
            margin-top: 30px;
            padding: 30px;
            background: rgba(16, 185, 129, 0.2);
            border-radius: 15px;
            border: 2px solid rgba(16, 185, 129, 0.3);
        }
        
        .proof-section {
            background: rgba(30, 41, 59, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
            border: 2px solid rgba(245, 158, 11, 0.3);
            text-align: center;
        }
        
        .proof-section h3 {
            font-size: 1.5em;
            margin-bottom: 15px;
            color: #f59e0b;
        }
        
        .proof-section p {
            color: #94a3b8;
            margin-bottom: 20px;
        }
        
        .summary-box {
            background: rgba(15, 23, 42, 0.6);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            text-align: center;
        }
        
        .summary-item {
            display: inline-block;
            margin: 15px 30px;
            font-size: 1.2em;
        }
        
        .summary-item strong {
            display: block;
            font-size: 1.5em;
            margin-top: 5px;
        }
        
        .hidden {
            display: none;
        }
        
        /* Painel Educacional */
        .educational-panel {
            background: rgba(30, 41, 59, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border: 2px solid rgba(139, 92, 246, 0.3);
        }
        
        .educational-content h3 {
            color: #8b5cf6;
            margin-bottom: 15px;
        }
        
        .educational-details {
            margin-top: 15px;
            padding: 15px;
            background: rgba(15, 23, 42, 0.6);
            border-radius: 10px;
            font-size: 0.95em;
            line-height: 1.6;
        }
        
        /* Informa√ß√µes de Algoritmo */
        .algorithm-info {
            text-align: center;
            font-size: 0.9em;
            color: #94a3b8;
            margin-bottom: 15px;
            padding: 8px;
            background: rgba(15, 23, 42, 0.4);
            border-radius: 8px;
        }
        
        /* Barra de Progresso */
        .attack-progress {
            width: 100%;
            margin-top: 20px;
            padding: 15px;
            background: rgba(15, 23, 42, 0.6);
            border-radius: 10px;
        }
        
        .progress-label {
            font-size: 0.9em;
            color: #cbd5e1;
            margin-bottom: 8px;
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(71, 85, 105, 0.5);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 8px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ef4444, #dc2626);
            transition: width 0.5s ease;
            width: 0%;
        }
        
        .progress-fill.protected {
            background: linear-gradient(90deg, #10b981, #059669);
        }
        
        .progress-text {
            font-size: 0.85em;
            color: #94a3b8;
            text-align: center;
        }
        
        /* Explica√ß√µes de Ataque */
        .attack-explanation {
            margin-top: 20px;
            padding: 15px;
            background: rgba(15, 23, 42, 0.6);
            border-radius: 10px;
            font-size: 0.9em;
            line-height: 1.6;
            color: #cbd5e1;
            min-height: 60px;
        }
        
        .layer-algorithm {
            font-size: 0.85em;
            color: #64748b;
            margin-bottom: 5px;
        }
        
        /* Bot√£o Voltar Padronizado */
        .btn-back {
            display: inline-block;
            padding: 8px 16px;
            background: #374151;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-size: 14px;
            transition: background 0.2s;
        }
        
        .btn-back:hover {
            background: #4b5563;
        }
</style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <a href="/" class="btn-back">
{{ t('back') or 'Back' }}
        </a>
        
        <h1>üî¨ {{ t('quantum_attack_simulator') or 'Quantum Attack Simulator' }}</h1>
        <p class="subtitle">{{ t('see_visually_how_attack_works') or 'See visually how a quantum attack works and why Allianza is protected' }}</p>
        
        <!-- Bot√£o Principal -->
        <div class="btn-container">
            <button class="btn btn-primary" onclick="startTest()" id="start-btn">
                üöÄ {{ t('run_quantum_test') or 'Run Quantum Test' }}
            </button>
        </div>
        
        <!-- Processo Visual Passo a Passo -->
        <div class="process-container" id="process-container">
            <div class="process-header">
                <h2>‚öôÔ∏è Test Process Running</h2>
                <p style="color: #94a3b8;">Follow each test step in real time</p>
            </div>
            <div class="process-steps" id="process-steps">
                <div class="step-item pending" id="step-1">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <div class="step-title">Preparando simula√ß√£o...</div>
                        <div class="step-description">Inicializando sistemas de seguran√ßa qu√¢ntica</div>
                    </div>
                    <div class="step-status">‚è≥</div>
                </div>
                
                <div class="step-item pending" id="step-2">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <div class="step-title">Animando ataque qu√¢ntico...</div>
                        <div class="step-description">Mostrando visualmente como o ataque funciona</div>
                    </div>
                    <div class="step-status">‚è≥</div>
                </div>
                
                <div class="step-item pending" id="step-3">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <div class="step-title">Testando prote√ß√µes...</div>
                        <div class="step-description">Validando resist√™ncia qu√¢ntica</div>
                    </div>
                    <div class="step-status">‚è≥</div>
                </div>
                
                <div class="step-item pending" id="step-4">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <div class="step-title">Gerando prova t√©cnica...</div>
                        <div class="step-description">Criando JSON verific√°vel com todas as evid√™ncias</div>
                    </div>
                    <div class="step-status">‚è≥</div>
                </div>
            </div>
        </div>
        
        <!-- Explica√ß√£o Educacional -->
        <div class="educational-panel" id="educational-panel" style="display: none;">
            <div class="educational-content">
                <h3 id="educational-title">Understanding Quantum Attacks</h3>
                <p id="educational-text">Quantum computers can break traditional cryptography by solving problems that are impossible for classical computers.</p>
                <div class="educational-details" id="educational-details"></div>
            </div>
        </div>
        
        <!-- Anima√ß√£o Visual do Ataque -->
        <div class="attack-animation-container" id="attack-animation" style="display: none;">
            <!-- Blockchain Tradicional -->
            <div class="animation-panel traditional">
                <div class="animation-title traditional">üî¥ Blockchain Tradicional (ECDSA)</div>
                <div class="algorithm-info">Algorithm: ECDSA-secp256k1 | Key Size: 256 bits</div>
                <div class="wallet-container" id="traditional-wallet">
                    <div class="wallet-icon">üíº</div>
                    <div class="lock-container">
                        <div class="lock-icon" id="traditional-lock">üîí</div>
                        <div class="key-icon" id="traditional-key">üîë</div>
                    </div>
                    <div class="funds-display" id="traditional-funds">10.0 BTC</div>
                    <div class="attack-progress" id="traditional-progress">
                        <div class="progress-label">Attack Progress:</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="traditional-progress-fill"></div>
                        </div>
                        <div class="progress-text" id="traditional-progress-text">0%</div>
                    </div>
                    <div class="qubits-container" id="traditional-qubits"></div>
                    <div class="attack-explanation" id="traditional-explanation"></div>
                </div>
            </div>
            
            <!-- Blockchain Allianza -->
            <div class="animation-panel protected">
                <div class="animation-title protected">üü¢ Allianza Protected (QRS-3)</div>
                <div class="algorithm-info">Triple Redundancy: ECDSA + ML-DSA-128 + SPHINCS+</div>
                <div class="wallet-container" id="protected-wallet">
                    <div class="wallet-icon">üíº</div>
                    <div class="lock-container">
                        <div class="lock-icon secure" id="protected-lock">üîí</div>
                    </div>
                    <div class="funds-display protected" id="protected-funds">10.0 BTC</div>
                    <div class="attack-progress" id="protected-progress">
                        <div class="progress-label">Attack Attempts:</div>
                        <div class="progress-bar">
                            <div class="progress-fill protected" id="protected-progress-fill"></div>
                        </div>
                        <div class="progress-text" id="protected-progress-text">0/3 layers attacked</div>
                    </div>
                    <div class="layers-container" id="protection-layers">
                        <div class="protection-layer layer1" id="layer1">
                            <div class="layer-name">üõ°Ô∏è Layer 1: ECDSA (Traditional)</div>
                            <div class="layer-algorithm">Algorithm: secp256k1 | Status: Fallback</div>
                            <div class="layer-status">Waiting for quantum attack...</div>
                            <div class="attack-indicator">‚è≥</div>
                        </div>
                        <div class="protection-layer layer2" id="layer2">
                            <div class="layer-name">üõ°Ô∏è Layer 2: ML-DSA-128 (Post-Quantum)</div>
                            <div class="layer-algorithm">Standard: FIPS 204 | Security: 128 quantum bits</div>
                            <div class="layer-status">Waiting for quantum attack...</div>
                            <div class="attack-indicator">‚è≥</div>
                        </div>
                        <div class="protection-layer layer3" id="layer3">
                            <div class="layer-name">üõ°Ô∏è Layer 3: SPHINCS+ (Post-Quantum)</div>
                            <div class="layer-algorithm">Standard: FIPS 205 | Security: 128 quantum bits</div>
                            <div class="layer-status">Waiting for quantum attack...</div>
                            <div class="attack-indicator">‚è≥</div>
                        </div>
                    </div>
                    <div class="attack-explanation" id="protected-explanation"></div>
                </div>
            </div>
        </div>
        
        <!-- Resultados -->
        <div id="results">
            <!-- Resumo Visual -->
            <div class="summary-box">
                <h2 style="margin-bottom: 20px;">üìä Resumo do Teste</h2>
                <div class="summary-item">
                    <div>Blockchain Tradicional</div>
                    <strong style="color: #ef4444;">‚ùå Comprometida</strong>
                </div>
                <div class="summary-item">
                    <div>Allianza QRS-3</div>
                    <strong style="color: #10b981;">üü¢ Protegida</strong>
                </div>
                <div class="summary-item">
                    <div>Fundos Roubados</div>
                    <strong id="summary-stolen" style="color: #ef4444;">10.0 BTC</strong>
                </div>
                <div class="summary-item">
                    <div>Fundos Protegidos</div>
                    <strong id="summary-protected" style="color: #10b981;">0.0 BTC</strong>
                </div>
            </div>
            
            <!-- Tabela Simplificada -->
            <div class="comparison-table">
                <h2>üìã O que aconteceu? (Explica√ß√£o Simples)</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Sistema</th>
                            <th>O que aconteceu</th>
                            <th>Por qu√™</th>
                        </tr>
                    </thead>
                    <tbody id="comparison-tbody">
                    </tbody>
                </table>
                <div style="margin-top: 20px; padding: 20px; background: rgba(16, 185, 129, 0.1); border-radius: 10px; border-left: 4px solid #10b981;">
                    <p style="font-size: 1.1em; line-height: 1.6;">
                        <strong>üí° Explica√ß√£o:</strong> O ataque qu√¢ntico conseguiu quebrar apenas a primeira camada (ECDSA tradicional). 
                        As outras duas camadas usam algoritmos p√≥s-qu√¢nticos aprovados pelo NIST (ML-DSA e SPHINCS+) e 
                        <strong>N√ÉO podem ser quebradas nem por computadores qu√¢nticos</strong>.
                    </p>
                </div>
            </div>
            
            <!-- Conclus√£o -->
            <div class="conclusion" id="conclusion"></div>
            
            <!-- Se√ß√£o de Prova T√©cnica -->
            <div class="proof-section" id="proof-section" style="display: none;">
                <h3>üìÑ Complete Cryptographic Proof</h3>
                <p>The test completed successfully. Download the complete JSON file containing:</p>
                <ul style="text-align: left; display: inline-block; color: #94a3b8; margin: 15px 0;">
                    <li>‚úÖ Real PQC signatures (ML-DSA-128 + SPHINCS+)</li>
                    <li>‚úÖ Canonical SHA-256 hash (RFC 8785)</li>
                    <li>‚úÖ Complete mathematical calculations</li>
                    <li>‚úÖ NIST FIPS 204/205 parameters</li>
                    <li>‚úÖ Quantum resource estimates</li>
                    <li>‚úÖ Independent verification commands</li>
                    <li>‚úÖ Scientific references and papers</li>
                    <li>‚úÖ Attack complexity analysis</li>
                    <li>‚úÖ Security margin calculations</li>
                </ul>
                <div style="background: rgba(15, 23, 42, 0.6); padding: 20px; border-radius: 10px; margin: 20px 0; text-align: left;">
                    <h4 style="color: #f59e0b; margin-bottom: 10px;">üìä Mathematical Proofs Included:</h4>
                    <ul style="color: #cbd5e1; line-height: 1.8;">
                        <li><strong>ECDSA Attack:</strong> Shor's Algorithm complexity (O((log N)¬≥))</li>
                        <li><strong>ML-DSA Resistance:</strong> Lattice-based security (2^128 quantum bits)</li>
                        <li><strong>SPHINCS+ Resistance:</strong> Hash-based security (2^128 quantum bits)</li>
                        <li><strong>Comparison:</strong> Security improvement factor calculations</li>
                        <li><strong>References:</strong> NIST standards, scientific papers, implementation guides</li>
                    </ul>
                </div>
                <p style="color: #f59e0b; font-weight: 600; margin-top: 20px;">
                    This file serves as a verifiable technical proof for auditors, developers, and financial institutions.
                </p>
                <button class="btn btn-proof" onclick="downloadProof()" id="download-proof-btn">
                    üì• Download Complete Cryptographic Proof
                </button>
                <p id="proof-file-path" style="margin-top: 15px; font-family: monospace; font-size: 0.9em; color: #64748b;"></p>
            </div>
        </div>
    </div>
    
    <script>
        let lastJSONFile = null;
        let simulationData = null;
        
        async function startTest() {
            // Esconder bot√£o inicial
            document.getElementById('start-btn').style.display = 'none';
            
            // Mostrar processo
            document.getElementById('process-container').classList.add('active');
            
            // Resetar steps
            for (let i = 1; i <= 4; i++) {
                const step = document.getElementById(`step-${i}`);
                step.classList.remove('active', 'completed');
                step.classList.add('pending');
                step.querySelector('.step-status').textContent = '‚è≥';
            }
            
            // Step 1: Preparar
            await executeStep(1, 'Preparando simula√ß√£o...', 'Sistemas inicializados');
            await delay(1000);
            
            // Step 2: Mostrar anima√ß√£o
            await executeStep(2, 'Animating quantum attack...', 'Visualizing attack process step by step...');
            await delay(500);
            
            // Mostrar painel educacional
            document.getElementById('educational-panel').style.display = 'block';
            document.getElementById('educational-title').textContent = 'Understanding Quantum Attacks';
            document.getElementById('educational-text').textContent = 'Quantum computers can break traditional cryptography (like ECDSA) using Shor\'s Algorithm, which solves problems in polynomial time that would take classical computers exponential time.';
            document.getElementById('educational-details').innerHTML = '<strong>How it works:</strong><br>1. Attacker observes a public transaction<br>2. Uses quantum computer to run Shor\'s Algorithm<br>3. Recovers the private key in polynomial time<br>4. Creates fraudulent transactions';
            await delay(3000);
            
            // Mostrar anima√ß√£o
            document.getElementById('attack-animation').style.display = 'grid';
            await delay(500);
            
            // Animar ataque na blockchain tradicional
            await animateTraditionalAttack();
            
            // Atualizar painel educacional
            document.getElementById('educational-title').textContent = 'Why Allianza is Protected';
            document.getElementById('educational-text').textContent = 'Allianza uses QRS-3 (Triple Redundancy Quantum Security) with post-quantum algorithms that cannot be broken by quantum computers.';
            document.getElementById('educational-details').innerHTML = '<strong>QRS-3 Protection:</strong><br>‚Ä¢ Layer 1: ECDSA (fallback, can be broken)<br>‚Ä¢ Layer 2: ML-DSA-128 (FIPS 204) - UNBREAKABLE<br>‚Ä¢ Layer 3: SPHINCS+ (FIPS 205) - UNBREAKABLE<br><br><strong>Result:</strong> Even if Layer 1 is broken, Layers 2 and 3 protect your funds.';
            await delay(2000);
            
            // Animar prote√ß√£o na Allianza
            await animateProtectedDefense();
            
            completeStep(2);
            await delay(1000);
            
            // Step 3: Testar prote√ß√µes
            await executeStep(3, 'Testando prote√ß√µes...', 'Validando resist√™ncia qu√¢ntica');
            await delay(1500);
            completeStep(3);
            
            // Step 4: Gerar prova
            await executeStep(4, 'Gerando prova t√©cnica...', 'Executando simula√ß√£o completa...');
            
            try {
                const response = await fetch('/dashboard/api/quantum-attack-simulator/run');
                const data = await response.json();
                
                if (data.success) {
                    simulationData = data.simulation;
                    lastJSONFile = data.json_file;
                    completeStep(4);
                    
                    await delay(500);
                    displayResults(data.simulation);
                } else {
                    throw new Error(data.error || 'Erro desconhecido');
                }
            } catch (error) {
                alert('Erro ao executar simula√ß√£o: ' + error.message);
            }
        }
        
        async function executeStep(stepNum, title, description) {
            const step = document.getElementById(`step-${stepNum}`);
            step.classList.remove('pending');
            step.classList.add('active');
            step.querySelector('.step-status').textContent = '‚è≥';
            step.querySelector('.step-title').textContent = title;
            step.querySelector('.step-description').textContent = description;
        }
        
        function completeStep(stepNum) {
            const step = document.getElementById(`step-${stepNum}`);
            step.classList.remove('active');
            step.classList.add('completed');
            step.querySelector('.step-status').textContent = '‚úÖ';
        }
        
        async function animateTraditionalAttack() {
            const lock = document.getElementById('traditional-lock');
            const key = document.getElementById('traditional-key');
            const funds = document.getElementById('traditional-funds');
            const qubitsContainer = document.getElementById('traditional-qubits');
            const explanation = document.getElementById('traditional-explanation');
            const progressFill = document.getElementById('traditional-progress-fill');
            const progressText = document.getElementById('traditional-progress-text');
            const lockContainer = lock.parentElement;
            
            // Limpar qubits anteriores
            qubitsContainer.innerHTML = '';
            
            // FASE 1: Observar transa√ß√£o p√∫blica
            explanation.innerHTML = '<strong>Phase 1:</strong> Attacker observes public transaction on blockchain...';
            await delay(1000);
            explanation.innerHTML = '<strong>Phase 1:</strong> ‚úÖ ECDSA signature captured from public transaction<br><small>Signature: 0x7f3bbee8bedefd8c972ee32103ad3cff2ad88ccacff1dc566d4f6ab179f3599f...</small>';
            await delay(1500);
            
            // FASE 2: Iniciar ataque Shor's Algorithm
            explanation.innerHTML = '<strong>Phase 2:</strong> ‚öõÔ∏è Initializing Shor\'s Algorithm...<br><small>Target: ECDSA private key (secp256k1, 256 bits)</small>';
            progressFill.style.width = '25%';
            progressText.textContent = '25% - Initializing quantum computer...';
            await delay(1000);
            
            // Criar qubits atacando (mais organizados)
            const lockRect = lockContainer.getBoundingClientRect();
            const containerRect = qubitsContainer.getBoundingClientRect();
            const lockCenterX = ((lockRect.left + lockRect.width/2) - containerRect.left) / containerRect.width * 100;
            const lockCenterY = ((lockRect.top + lockRect.height/2) - containerRect.top) / containerRect.height * 100;
            
            explanation.innerHTML = '<strong>Phase 2:</strong> ‚öõÔ∏è Applying Quantum Fourier Transform...<br><small>Using ~20-30 million logical qubits</small>';
            progressFill.style.width = '50%';
            progressText.textContent = '50% - Quantum Fourier Transform...';
            
            for (let i = 0; i < 15; i++) {
                const qubit = document.createElement('div');
                qubit.className = 'qubit';
                const angle = (i / 15) * Math.PI * 2;
                const radius = 40;
                const startX = 50 + Math.cos(angle) * radius;
                const startY = 50 + Math.sin(angle) * radius;
                
                qubit.style.left = startX + '%';
                qubit.style.top = startY + '%';
                qubit.style.setProperty('--target-x', (lockCenterX - startX) + '%');
                qubit.style.setProperty('--target-y', (lockCenterY - startY) + '%');
                qubit.style.animationDelay = (i * 0.12) + 's';
                qubitsContainer.appendChild(qubit);
            }
            
            await delay(2000);
            
            explanation.innerHTML = '<strong>Phase 2:</strong> ‚öõÔ∏è Executing Shor\'s Algorithm...<br><small>Complexity: O((log N)¬≥) - Polynomial time attack</small>';
            progressFill.style.width = '75%';
            progressText.textContent = '75% - Executing Shor\'s Algorithm...';
            await delay(1500);
            
            // FASE 3: Chave recuperada
            explanation.innerHTML = '<strong>Phase 3:</strong> ‚úÖ Private key recovered!<br><small>ECDSA vulnerability: COMPLETE - Key extracted in polynomial time</small>';
            progressFill.style.width = '100%';
            progressText.textContent = '100% - Attack successful!';
            
            // Quebrar cadeado
            lock.classList.add('broken');
            lock.textContent = 'üîì';
            
            await delay(800);
            
            // Mostrar chave
            key.classList.add('visible');
            explanation.innerHTML = '<strong>Result:</strong> üîë Private key extracted: 5KYZdUEo39z3FPrtuX2QbbwGnNP5zTd7yyr2SC1j299sBCnWjss<br><small>Attack time: ~4.2 seconds (simulated) | Real: days to months with error correction</small>';
            
            await delay(1500);
            
            // FASE 4: Roubar fundos
            explanation.innerHTML = '<strong>Phase 4:</strong> üí∏ Creating fraudulent transaction...<br><small>Signing with recovered private key</small>';
            await delay(800);
            
            funds.classList.add('stolen');
            funds.textContent = '0.0 BTC';
            explanation.innerHTML = '<strong>‚ùå ATTACK SUCCESSFUL:</strong> All 10.0 BTC stolen!<br><small>Traditional blockchain (ECDSA) is completely vulnerable to quantum attacks</small>';
            
            await delay(1000);
        }
        
        async function animateProtectedDefense() {
            const layer1 = document.getElementById('layer1');
            const layer2 = document.getElementById('layer2');
            const layer3 = document.getElementById('layer3');
            const explanation = document.getElementById('protected-explanation');
            const progressFill = document.getElementById('protected-progress-fill');
            const progressText = document.getElementById('protected-progress-text');
            
            explanation.innerHTML = '<strong>QRS-3 Protection:</strong> Triple redundancy signature system active<br><small>3 independent cryptographic layers protect the transaction</small>';
            await delay(1000);
            
            // Ataque na camada 1 (ECDSA) - quebra (mas n√£o √© suficiente)
            explanation.innerHTML = '<strong>Attack Attempt 1:</strong> ‚öõÔ∏è Attacking Layer 1 (ECDSA)...<br><small>Using Shor\'s Algorithm (same as traditional blockchain)</small>';
            progressFill.style.width = '33%';
            progressText.textContent = '1/3 layers attacked';
            await delay(800);
            
            layer1.classList.add('attacked');
            layer1.querySelector('.layer-status').textContent = '‚ùå Broken by quantum attack (expected - fallback layer)';
            layer1.querySelector('.attack-indicator').textContent = '‚ùå';
            explanation.innerHTML = '<strong>Result:</strong> ‚ö†Ô∏è ECDSA layer broken, BUT...<br><small>ECDSA alone is NOT sufficient to validate transaction! QRS-3 requires 2 of 3 signatures.</small>';
            await delay(2000);
            
            // Ataque na camada 2 (ML-DSA) - resiste
            explanation.innerHTML = '<strong>Attack Attempt 2:</strong> ‚öõÔ∏è Attacking Layer 2 (ML-DSA-128)...<br><small>Trying Shor\'s Algorithm on lattice-based problem...</small>';
            progressFill.style.width = '66%';
            progressText.textContent = '2/3 layers attacked';
            await delay(1000);
            
            explanation.innerHTML = '<strong>Attack Attempt 2:</strong> ‚ùå Shor\'s Algorithm FAILED!<br><small>Shor\'s only works on factorization/discrete log. ML-DSA uses lattice problems (LWE).</small>';
            await delay(1500);
            
            explanation.innerHTML = '<strong>Attack Attempt 2:</strong> ‚öõÔ∏è Trying Grover\'s Algorithm...<br><small>Search algorithm - only provides quadratic speedup</small>';
            await delay(1000);
            
            explanation.innerHTML = '<strong>Attack Attempt 2:</strong> ‚ùå Grover\'s Algorithm FAILED!<br><small>Complexity: 2^143 ‚Üí 2^128 (insufficient). ML-DSA security: 128 quantum bits (NIST Level 3)</small>';
            await delay(1500);
            
            layer2.classList.add('resisted');
            layer2.querySelector('.layer-status').textContent = '‚úÖ RESISTED - Post-quantum algorithm (FIPS 204)';
            layer2.querySelector('.attack-indicator').textContent = '‚úÖ';
            explanation.innerHTML = '<strong>Result:</strong> ‚úÖ ML-DSA-128 RESISTED all quantum attacks!<br><small>Standard: FIPS 204 | Security: 128 quantum bits | Status: UNBREAKABLE</small>';
            await delay(2000);
            
            // Ataque na camada 3 (SPHINCS+) - resiste
            explanation.innerHTML = '<strong>Attack Attempt 3:</strong> ‚öõÔ∏è Attacking Layer 3 (SPHINCS+)...<br><small>Hash-based signature - trying quantum attacks...</small>';
            progressFill.style.width = '100%';
            progressText.textContent = '3/3 layers attacked';
            await delay(1000);
            
            explanation.innerHTML = '<strong>Attack Attempt 3:</strong> ‚ùå All quantum attacks FAILED!<br><small>SPHINCS+ uses hash-based signatures. Shor\'s doesn\'t apply. Grover provides only quadratic speedup (insufficient).</small>';
            await delay(1500);
            
            layer3.classList.add('resisted');
            layer3.querySelector('.layer-status').textContent = '‚úÖ RESISTED - Post-quantum algorithm (FIPS 205)';
            layer3.querySelector('.attack-indicator').textContent = '‚úÖ';
            explanation.innerHTML = '<strong>Result:</strong> ‚úÖ SPHINCS+ RESISTED all quantum attacks!<br><small>Standard: FIPS 205 | Security: 128 quantum bits | Status: UNBREAKABLE</small>';
            await delay(2000);
            
            // Conclus√£o
            explanation.innerHTML = '<strong>üõ°Ô∏è PROTECTION SUCCESSFUL:</strong> QRS-3 system resisted all quantum attacks!<br><small>Even though Layer 1 (ECDSA) was broken, Layers 2 and 3 (ML-DSA + SPHINCS+) resisted all attacks. Funds: PROTECTED ‚úÖ</small>';
            await delay(2000);
        }
        
        function delay(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
        
        function displayResults(simulation) {
            // Esconder processo e anima√ß√£o
            document.getElementById('process-container').style.display = 'none';
            document.getElementById('attack-animation').style.display = 'none';
            
            // Mostrar resultados
            document.getElementById('results').classList.add('active');
            
            const traditional = simulation.traditional;
            const protected = simulation.protected;
            
            // Atualizar resumo
            document.getElementById('summary-stolen').textContent = traditional.funds_stolen + ' BTC';
            document.getElementById('summary-protected').textContent = '0.0 BTC';
            
            // Tabela simplificada com dados t√©cnicos
            const mathProofs = simulation.mathematical_proofs || {};
            const ecdsaProof = mathProofs.ecdsa_attack || {};
            const mlDsaProof = mathProofs.ml_dsa_resistance || {};
            const sphincsProof = mathProofs.sphincs_resistance || {};
            
            document.getElementById('comparison-tbody').innerHTML = `
                <tr>
                    <td><strong>Traditional Blockchain (ECDSA)</strong></td>
                    <td>‚ùå Hacked</td>
                    <td>
                        <strong>Attack:</strong> Shor's Algorithm (Q2 model)<br>
                        <strong>Complexity:</strong> ${ecdsaProof.complexity || 'O((log N)¬≥)'} - Polynomial time<br>
                        <strong>Qubits Required:</strong> ${ecdsaProof.qubits_required || '20-30 million logical'} (${ecdsaProof.physical_qubits || '2-4 billion physical'})<br>
                        <strong>Attack Time:</strong> ${ecdsaProof.attack_time_estimate || 'Days to months'} (with error correction)<br>
                        <strong>Feasibility:</strong> FEASIBLE in CRQC (Cryptographically Relevant Quantum Computer)<br>
                        <strong>Result:</strong> Private key recovered - ALL FUNDS STOLEN
                    </td>
                </tr>
                <tr>
                    <td><strong>Allianza QRS-3</strong></td>
                    <td>‚úÖ Protected</td>
                    <td>
                        <strong>Layer 1 (ECDSA):</strong> Broken (expected - fallback only)<br>
                        <strong>Layer 2 (ML-DSA-128):</strong> ‚úÖ RESISTED<br>
                        &nbsp;&nbsp;‚Ä¢ Standard: ${mlDsaProof.standard || 'FIPS 204'}<br>
                        &nbsp;&nbsp;‚Ä¢ Security: ${mlDsaProof.security_level_quantum_bits || '128'} quantum bits<br>
                        &nbsp;&nbsp;‚Ä¢ Complexity: ${mlDsaProof.classical_complexity || '2^143'} operations<br>
                        <strong>Layer 3 (SPHINCS+):</strong> ‚úÖ RESISTED<br>
                        &nbsp;&nbsp;‚Ä¢ Standard: ${sphincsProof.standard || 'FIPS 205'}<br>
                        &nbsp;&nbsp;‚Ä¢ Security: ${sphincsProof.security_level_quantum_bits || '128'} quantum bits<br>
                        <strong>Result:</strong> QRS-3 requires 2 of 3 signatures - FUNDS PROTECTED ‚úÖ
                    </td>
                </tr>
            `;
            
            // Conclus√£o
            document.getElementById('conclusion').innerHTML = `
                <h3 style="margin-bottom: 15px;">‚úÖ Resultado: Sistema Protegido</h3>
                <p>A blockchain Allianza com prote√ß√£o QRS-3 demonstrou resist√™ncia completa aos ataques qu√¢nticos simulados.</p>
                <p style="margin-top: 10px; font-size: 0.9em; opacity: 0.8;">
                    The traditional system (ECDSA) is vulnerable to polynomial-time quantum attacks (feasible in CRQC), 
                    while the protected system (QRS-3) resisted all attacks with exponential complexity (2^128 quantum bits required).
                </p>
            `;
            
            // Mostrar se√ß√£o de prova
            if (lastJSONFile) {
                document.getElementById('proof-section').style.display = 'block';
                document.getElementById('proof-file-path').textContent = `Arquivo: ${lastJSONFile}`;
            }
        }
        
        function downloadProof() {
            if (lastJSONFile) {
                window.open('/dashboard/api/quantum-attack-simulator/download?file=' + encodeURIComponent(lastJSONFile), '_blank');
            } else {
                alert('Nenhuma prova dispon√≠vel. Execute o teste primeiro.');
            }
        }
    </script>
</body>
</html>
